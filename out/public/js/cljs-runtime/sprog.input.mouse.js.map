{"version":3,"sources":["sprog/input/mouse.cljs"],"mappings":"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","names":["js/sprog","js/sprog.input","js/sprog.input.mouse","js/sprog.input.mouse.mouse-atom","sprog.input.mouse/mouse-atom","cljs.core.atom","js/sprog.input.mouse.mouse-callbacks-atom","sprog.input.mouse/mouse-callbacks-atom","sprog.input.mouse/add-mouse-down-callback","callback","cljs.core.swap_BANG_","cljs.core/update","cljs.core/conj","sprog.input.mouse/add-mouse-up-callback","sprog.input.mouse/add-scroll-x-callback","sprog.input.mouse/add-scroll-y-callback","sprog.input.mouse/mouse-pos","cljs.core/deref","sprog.input.mouse/mouse-down?","sprog.input.mouse/mouse-present?","js/document.onmousemove","event","x","y","w","js/window.innerWidth","h","js/window.innerHeight","s","x__5131__auto__","y__5132__auto__","cljs.core/assoc","js/document.onmousedown","_","seq__44419","cljs.core/seq","chunk__44420","count__44421","i__44422","temp__5804__auto__","cljs.core/chunked-seq?","c__5565__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","js/document.onmouseup","seq__44456","chunk__44457","count__44458","i__44459","js/document.onmousewheel","seq__44500","chunk__44501","count__44502","i__44503","seq__44508","chunk__44509","count__44510","i__44511","js/document.onmouseenter","p1__44521#","cljs.core.assoc","js/document.onmouseleave","p1__44525#"],"sourcesContent":["(ns sprog.input.mouse)\n\n(defonce mouse-atom (atom {:pos [0.5 0.5]\n                           :down? false\n                           :present? false}))\n\n(defonce mouse-callbacks-atom (atom {}))\n\n(defn add-mouse-down-callback [callback]\n  (swap! mouse-callbacks-atom update :down conj callback))\n\n(defn add-mouse-up-callback [callback]\n  (swap! mouse-callbacks-atom update :up conj callback))\n\n(defn add-scroll-x-callback [callback]\n  (swap! mouse-callbacks-atom update :scroll-x conj callback))\n\n(defn add-scroll-y-callback [callback]\n  (swap! mouse-callbacks-atom update :scroll-y conj callback))\n\n(defn mouse-pos []\n  (:pos @mouse-atom))\n\n(defn mouse-down? []\n  (:down? @mouse-atom))\n\n(defn mouse-present? []\n  (:present? @mouse-atom))\n\n(set! js/document.onmousemove\n      (fn [event]\n        (let [x event.clientX\n              y event.clientY\n              w js/window.innerWidth\n              h js/window.innerHeight\n              s (min w h)]\n          (swap! mouse-atom\n                 assoc\n                 :pos [(/ (- x (/ (- w s) 2)) s)\n                       (/ (- y (/ (- h s) 2)) s)]\n                 :present? true))))\n\n(set! js/document.onmousedown\n      (fn [_]\n        (doseq [callback (:down @mouse-callbacks-atom)]\n          (callback))\n        (swap! mouse-atom\n               assoc\n               :down? true\n               :present? true)))\n\n(set! js/document.onmouseup\n      (fn [_]\n        (doseq [callback (:up @mouse-callbacks-atom)]\n          (callback))\n        (swap! mouse-atom\n               assoc\n               :down? false\n               :present? true)))\n\n(set! js/document.onmousewheel\n      (fn [event]\n        (doseq [callback (:scroll-x @mouse-callbacks-atom)]\n          (callback event.deltaX))\n        (doseq [callback (:scroll-y @mouse-callbacks-atom)]\n          (callback event.deltaY))))\n\n(set! js/document.onmouseenter\n      (fn [_]\n        (swap! mouse-atom\n               #(-> %\n                    (assoc :present? true)))))\n\n(set! js/document.onmouseleave\n      (fn [_]\n        (swap! mouse-atom\n               #(-> %\n                    (assoc :pos [0.5 0.5])\n                    (assoc :down? false)\n                    (assoc :present? false)))))\n"]}