{"version":3,"sources":["sprog/dev/fn_sort_demo.cljs"],"mappings":";AAWA,kCAAA,lCAAKA;AAEL,GAAA,QAAAC,kCAAAC,sCAAAC,mDAAAC;AAAA;AAAA,AAAA,AAASC,iCAAQ,6CAAA,7CAACC;;AAClB,GAAA,QAAAL,kCAAAC,sCAAAC,mDAAAI;AAAA;AAAA,AAAA,AAASC,oCAAW,6CAAA,7CAACF;;AAErB,AAAKG,qCACH,AAACC,+CAAOC,+BACA,8BAAA,2CAAA,mNAAA,uHAAA,AAAA,nZAACC,gJACgB,AAACC,+CAAO,CAAA,gDAASb,8GACpB,wCAAA,xCAAUA,ipDAYxB,AAACc,4CAAI,WAAKC;AAAL,AACE,qCAAA,2CAAA,iLAAA,1PAACH,oIACU,AAACC,+CAAO,CAAA,gDAAS,KAAA,JAAKE,0FACjB,AAACF,+CAAO,CAAA,gDAASE,sBAChC,eAAA,AAAA,w4BAAA,AAAA,r5BAAI,OAAA,NAAOA;GAMd,AAACC,8CAAMhB;AAEtB,2CAAA,3CAAMiB;AAAN,AACE,SAAA,AAAAC,LAAMC,qBAAId;iBAAV,bACMe,gGAAY,AAAA,AAAAD,gBAAgB,AAAA,AAAAA;AADlC,AAEE,AAACE,sCAAmBF;;AACpB,AAACG,6CAAeH;;AAChB,uCAAA,AAAAD,8DAAA,2CAAA,0DAAA,2CAAA,rPAACK,uDAAoBf,mCACDY,kKACiBA;;AACrC,OAACI,sBAAyBP;;AAE9B,8BAAA,9BAAMQ;AAAN,AACE,IAAMN,WAAG,AAACO;AAAV,AACE,AAACC,sBAAOtB,+BAAQc;;AAChB,AAACQ,sBAAOnB,kCAAW,AAACoB,0CACAT,SACA,AAACU,8BAAWpB;;AAClC,OAACQ","names":["sprog.dev.fn-sort-demo/fn-count","js/sprog","js/sprog.dev","js/sprog.dev.fn-sort-demo","js/sprog.dev.fn-sort-demo.gl-atom","sprog.dev.fn-sort-demo/gl-atom","cljs.core.atom","js/sprog.dev.fn-sort-demo.sprog-atom","sprog.dev.fn-sort-demo/sprog-atom","sprog.dev.fn-sort-demo/frag-source","cljs.core.reduce","sprog.iglu.chunks/merge-chunks","clojure.walk/postwalk-replace","cljs.core.symbol","cljs.core.map","i","cljs.core.range","sprog.dev.fn-sort-demo/update-page!","cljs.core/deref","gl","resolution","sprog.webgl.canvas/maximize-gl-canvas","sprog.webgl.framebuffers/target-screen!","sprog.webgl.shaders/run-purefrag-sprog","js/requestAnimationFrame","sprog.dev.fn-sort-demo/init","sprog.webgl.canvas/create-gl-canvas","cljs.core/reset!","sprog.webgl.shaders/create-purefrag-sprog","sprog.iglu.core/iglu->glsl"],"sourcesContent":["(ns sprog.dev.fn-sort-demo\n  (:require [sprog.util :as u]\n            [sprog.webgl.canvas :refer [create-gl-canvas\n                                        maximize-gl-canvas]]\n            [sprog.webgl.shaders :refer [create-purefrag-sprog\n                                         run-purefrag-sprog]]\n            [sprog.webgl.framebuffers :refer [target-screen!]]\n            [sprog.iglu.chunks :refer [merge-chunks]]\n            [sprog.iglu.core :refer [iglu->glsl]]\n            [clojure.walk :refer [postwalk-replace]]))\n\n(def fn-count 50)\n\n(defonce gl-atom (atom nil))\n(defonce sprog-atom (atom nil))\n\n(def frag-source\n  (reduce merge-chunks\n          (postwalk-replace\n           {:final-fn-name (symbol (str \"f\" fn-count))\n            :fn-count-f (.toFixed fn-count 1)}\n           '{:version \"300 es\"\n             :precision {float highp}\n             :uniforms {size vec2}\n             :outputs {fragColor vec4}\n             :signatures {main ([] void)}\n             :functions {main\n                         ([]\n                          (= fragColor (vec4 (:final-fn-name \"0.0\")\n                                             0\n                                             0\n                                             1)))}})\n          (map (fn [i]\n                 (postwalk-replace\n                  {:fn-name (symbol (str \"f\" (inc i)))\n                   :prev-fn-name (symbol (str \"f\" i))}\n                  (if (zero? i)\n                    '{:signatures {:fn-name ([float] float)}\n                      :functions {:fn-name ([x] (+ x \"0.01\"))}}\n                    '{:signatures {:fn-name ([float] float)}\n                      :functions {:fn-name\n                                  ([x] (+ (:prev-fn-name x) \"0.01\"))}})))\n               (range fn-count))))\n\n(defn update-page! []\n  (let [gl @gl-atom\n        resolution [gl.canvas.width gl.canvas.height]]\n    (maximize-gl-canvas gl)\n    (target-screen! gl)\n    (run-purefrag-sprog @sprog-atom\n                        resolution\n                        {:floats {\"size\" resolution}})\n    (js/requestAnimationFrame update-page!)))\n\n(defn init []\n  (let [gl (create-gl-canvas)]\n    (reset! gl-atom gl)\n    (reset! sprog-atom (create-purefrag-sprog\n                        gl\n                        (iglu->glsl frag-source))))\n  (update-page!))\n"]}